"use strict";(self["webpackChunkrecord_app"]=self["webpackChunkrecord_app"]||[]).push([[366],{130:(e,n,t)=>{t.d(n,{XZ:()=>c,uJ:()=>s,Zz:()=>d,Tk:()=>u,AA:()=>f});var r=t(7201),i=function(e,n,t,r){function i(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,o){function a(e){try{c(r.next(e))}catch(n){o(n)}}function l(e){try{c(r["throw"](e))}catch(n){o(n)}}function c(e){e.done?t(e.value):i(e.value).then(a,l)}c((r=r.apply(e,n||[])).next())}))};const o=11921;let a;function l(){return a=(0,r.X3)("sound-memos",o,{upgrade(e){const n=e;n.createObjectStore("sound-db",{keyPath:"id"})},blocked(){},blocking(){},terminated(){}}),a}function c(){return i(this,void 0,void 0,(function*(){return l()}))}function s(e){return i(this,void 0,void 0,(function*(){return(yield a).put("sound-db",e)}))}function u(){return i(this,void 0,void 0,(function*(){return(yield a).getAll("sound-db")}))}function d(e){return i(this,void 0,void 0,(function*(){return(yield a).get("sound-db",e)}))}function f(e){return i(this,void 0,void 0,(function*(){return(yield a).delete("sound-db",e)}))}},9366:(e,n,t)=>{t.r(n),t.d(n,{default:()=>D});var r=t(3673);function i(e,n,t,i,o,a){const l=(0,r.up)("editor-component"),c=(0,r.up)("q-page");return(0,r.wg)(),(0,r.j4)(c,{class:"row items-center justify-evenly main-component"},{default:(0,r.w5)((()=>[(0,r.Wm)(l,{active:""})])),_:1})}t(71);var o=t(2323);const a={class:"editor-wrapper"},l={class:"title"},c=(0,r._)("div",{id:"waveform-timeline"},null,-1),s=(0,r._)("div",{id:"waveform"},null,-1),u={id:"wave-minimap",ref:"waveMinimap"},d={class:"info"},f={class:"time"},m={style:{position:"relative"}},p={class:"file-name"},h=(0,r._)("div",{class:"date-name"},[(0,r._)("p",null,"2021/10/24")],-1),v={class:"controls"},b={ref:"player",controls:"",style:{display:"none"}};function w(e,n,t,i,w,g){const y=(0,r.up)("q-btn"),C=(0,r.up)("q-input");return(0,r.wg)(),(0,r.iD)("div",a,[(0,r._)("h2",l,(0,o.zw)(e.title),1),(0,r._)("div",{onClick:n[0]||(n[0]=(...n)=>e.updateCurrentTime&&e.updateCurrentTime(...n))},[c,s,(0,r._)("div",u,null,512)]),(0,r._)("div",d,[(0,r._)("div",f,[(0,r._)("h4",null,[(0,r._)("span",m,[(0,r.Wm)(y,{onClick:e.onClickPlay,unelevated:"",icon:e.playButtonIcn,disable:"pause"===e.recordIcon||"mic"===e.recordIcon&&0==e.audioPlaySet.size,padding:"none",round:"",size:"xs",style:{"font-size":"1.75rem",padding:"0px","min-width":"0px","min-height":"0px",position:"absolute",margin:"0px",left:"-55px",top:"-4px"}},null,8,["onClick","icon","disable"])]),(0,r.Uk)(" "+(0,o.zw)(e.currentTime),1)])]),(0,r._)("div",p,[(0,r.Wm)(C,{standout:"",modelValue:e.onOpeningFileName,"onUpdate:modelValue":n[1]||(n[1]=n=>e.onOpeningFileName=n),dense:!0,style:{width:"400px",margin:"auto","font-size":"1.75rem"}},null,8,["modelValue"])]),h]),(0,r._)("div",v,[(0,r.Wm)(y,{outline:"","no-caps":"",class:"clear-btn",label:"Clear",onClick:e.onClickClear,disable:"pause"===e.recordIcon||"PLAYING"===e.title},null,8,["onClick","disable"]),(0,r.Wm)(y,{class:"record-btn",size:"lg",unelevated:"",round:"",icon:e.recordIcon,onClick:e.onClickRecord},null,8,["icon","onClick"]),(0,r.Wm)(y,{outline:"","no-caps":"",class:"done-btn",label:"Done",onClick:e.onClickDone,disable:"pause"===e.recordIcon},null,8,["onClick","disable"])]),(0,r._)("audio",b,null,512)])}var g=t(5777),y=t(4640),C=t(3221),O=t(130),k=t(9574);class P{constructor(){Object.defineProperty(this,"todos",{enumerable:!0,configurable:!0,writable:!0,value:(0,g.vg)({default:()=>[]})}),Object.defineProperty(this,"meta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"active",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}class I extends(g.w3["with"](P)){constructor(){super(...arguments),Object.defineProperty(this,"clickCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"recordIcon",{enumerable:!0,configurable:!0,writable:!0,value:"mic"}),Object.defineProperty(this,"playButtonIcn",{enumerable:!0,configurable:!0,writable:!0,value:"play_arrow"}),Object.defineProperty(this,"currentTime",{enumerable:!0,configurable:!0,writable:!0,value:"00:00.0"}),Object.defineProperty(this,"endOfRecord",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"wavesurfer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audioBuffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audioPlaySet",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"onOpeningFileName",{enumerable:!0,configurable:!0,writable:!0,value:"New Recording..."}),Object.defineProperty(this,"onOpeningId",{enumerable:!0,configurable:!0,writable:!0,value:(0,k.Z)()}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:"RECORD"})}mounted(){(0,O.XZ)(),this.wavesurfer=WaveSurfer.create({container:"#waveform",waveColor:"white",progressColor:"#46f0d4",barRadius:0,barWidth:1,barGap:3,height:200,cursorWidth:2,cursorColor:"#46f0d4",responsive:!0,scrollParent:!0,appendMode:!0,fillParent:!0,autoCenter:!0,barMinHeight:1,minPxPerSec:30,plugins:[WaveSurfer.timeline.create({container:"#waveform-timeline",fontSize:"14",fillParent:!0,scrollParent:!0,formatTimeCallback:e=>{if(e/60>=1){let n="00"+parseInt(""+e/60,10);e=parseInt(""+e%60,10);let t=`00${e}`.slice(-2);return"".concat(n.slice(-2),":").concat(t)}let n="00"+(Math.round(1e3*e)/1e3).toString();return`00:${n.slice(-2)}`}}),WaveSurfer.minimap.create({container:"#wave-minimap",waveColor:"#777",progressColor:"white",height:50}),WaveSurfer.microphone.create({})]}),this.wavesurfer.on("ready",(function(){}));const e=this;this.wavesurfer.on("audioprocess",(function(){let n=e.wavesurfer.getCurrentTime();e.currentTime=e.formatTime(n),console.log(n,e.endOfRecord),n+.1>=e.endOfRecord&&(e.playButtonIcn="play_arrow")})),this.wavesurfer.on("seek",(function(){e.currentTime=e.formatTime(e.wavesurfer.getCurrentTime())})),this.wavesurfer.microphone.on("deviceReady",(function(e){console.log("Device ready!",e)})),this.wavesurfer.microphone.on("deviceError",(function(e){console.warn("Device error: "+e)})),y.emitter.on("TAB_CHANGE",(n=>{setTimeout((()=>{e.wavesurfer.minimap._onZoom(0),setTimeout((()=>{e.wavesurfer.zoom(0)}),100)}),100)})),y.emitter.on("SELECT_SOUND",(n=>{e.onClickClear(),this.title="PLAYING",this.playButtonIcn="play_arrow",(0,O.Zz)(n).then((n=>{console.log(n),e.endOfRecord=n.time,e.audioPlaySet.add(n.id),e.onOpeningFileName=n.name,e.wavesurfer.loadBlob(n.blob)}))})),y.emitter.on("CREATE_NEW",(()=>{e.onClickClear(),e.title="RECORD",e.onOpeningFileName="New Recording..."}))}formatTime(e){let n=e.toFixed(1);if(e/60>=1){let t=parseInt(""+e/60,10),r=+n-60*t,i=`0${r.toFixed(1)}`.slice(-4);return"00".concat(t.toString()).slice(-2).concat(":",i)}let t="0"+n;return`00:${t.slice(-4)}`}updateCurrentTime(){this.currentTime=this.formatTime(this.wavesurfer.getCurrentTime())}onClickClear(){this.recordIcon,this.wavesurfer.minimap.empty(),this.wavesurfer.stop(),this.wavesurfer.empty(),this.endOfRecord=0}onClickPlay(){console.log("onClickPlay"),"play_arrow"===this.playButtonIcn?(this.playButtonIcn="stop",this.wavesurfer.play()):(this.playButtonIcn="play_arrow",this.wavesurfer.stop(),this.wavesurfer.seekAndCenter(1))}onClickRecord(){if(this.title="RECORD",this.wavesurfer.microphone.micContext.resume(),this.onOpeningId&&""!==this.onOpeningId.trim()||(this.onOpeningId=(0,k.Z)()),"mic"===this.recordIcon){this.wavesurfer.microphone.togglePlay(),this.audioPlaySet.has(this.onOpeningFileName)||this.audioPlaySet.add(this.onOpeningFileName),this.recordIcon="pause";let e=this.wavesurfer.getCurrentTime();e!==this.endOfRecord&&this.handleSlice(e)}else this.wavesurfer.microphone.togglePlay(),this.recordIcon="mic",this.endOfRecord=this.wavesurfer.getCurrentTime()}handleSlice(e){let n;(0,C.audioBufferSlice)(this.wavesurfer.backend.buffer,0,1e3*e,(function(e,t){e?console.error(e):n=t})),this.wavesurfer.backend.buffer=n}onClickDone(){const e=this;if(this.wavesurfer.microphone.stop(),this.recordIcon="mic",this.audioBuffer=this.wavesurfer.backend.buffer,this.audioBuffer){var n=new Worker("libs/recorderWorker.js");n.postMessage({command:"init",config:{sampleRate:48e3,numChannels:1}}),n.onmessage=function(n){var t=n.data;(0,O.uJ)({id:e.onOpeningId,name:e.onOpeningFileName,time:e.endOfRecord,blob:t,date:+new Date}),e.onOpeningId="",y.emitter.emit("LIST_CHANGE")},n.postMessage({command:"record",buffer:[this.audioBuffer.getChannelData(0)]}),n.postMessage({command:"exportWAV",type:"audio/wav"})}this.onClickClear()}}var _=t(6114),R=t(6805),T=t(7518),j=t.n(T);I.render=w;const S=I;j()(I,"components",{QBtn:_.Z,QInput:R.Z});var x=function(e,n,t,r){var i,o=arguments.length,a=o<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,n,t,r);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a};let N=class extends g.w3{};N=x([(0,g.Ei)({components:{EditorComponent:S}})],N);const W=N;var B=t(4379);W.render=i;const D=W;j()(W,"components",{QPage:B.Z})}}]);